\documentclass[a4paper]{article}
\usepackage{vntex}

\usepackage{a4wide,amssymb,epsfig,latexsym,multicol,array,hhline,fancyhdr}
\usepackage{booktabs}
\usepackage{amsmath}
\usepackage{lastpage}
\usepackage[lined,boxed,commentsnumbered]{algorithm2e}
\usepackage{enumerate}
\usepackage{color}
\usepackage{graphicx}
\usepackage{array}
\usepackage{tabularx, caption}
\usepackage{multirow}
\usepackage[framemethod=tikz]{mdframed}
\usepackage{multicol}
\usepackage{rotating}
\usepackage{graphics}
\usepackage{geometry}
\usepackage{setspace}
\usepackage{epsfig}
\usepackage{tikz}
\usepackage{float}
\usepackage{placeins}
\usepackage{listings}
\usetikzlibrary{arrows,snakes,backgrounds}
\usepackage{hyperref}
\hypersetup{urlcolor=blue,linkcolor=black,citecolor=black,colorlinks=true
\usepackage{array}
\usepackage{enumitem}  % để dùng [noitemsep,leftmargin=*]
}

\newtheorem{theorem}{{\bf Định lý}}
\newtheorem{property}{{\bf Tính chất}}
\newtheorem{proposition}{{\bf Mệnh đề}}
\newtheorem{corollary}[proposition]{{\bf Hệ quả}}
\newtheorem{lemma}[proposition]{{\bf Bổ đề}}

\everymath{\color{blue}}
\setlength{\headheight}{40pt}
\pagestyle{fancy}
\fancyhead{} % clear all header fields
\fancyhead[L]{
    \begin{tabular}{rl}
        \begin{picture}(25,15)(0,0)
            \put(0,-8){\includegraphics[width=8mm, height=8mm]{logoITSGUsmall.png}}
        \end{picture}&
        \begin{tabular}{l}
            \textbf{\bf \ttfamily Trường Đại học Sài Gòn}\\
            \textbf{\bf \ttfamily Khoa Công Nghệ Thông Tin}
        \end{tabular}
    \end{tabular}
}
\fancyhead[R]{
    \begin{tabular}{l}
        \tiny \bf \\
        \tiny \bf
    \end{tabular}  }
\fancyfoot{} % clear all footer fields
\fancyfoot[L]{\scriptsize \ttfamily Bài tập lớn môn Kiểm Thử Phần Mềm - Niên khóa 2025-2026}
\fancyfoot[R]{\scriptsize \ttfamily Trang {\thepage}/\pageref{LastPage}}
\renewcommand{\headrulewidth}{0.3pt}
\renewcommand{\footrulewidth}{0.3pt}

%%%
\setcounter{secnumdepth}{0} % Tắt đánh số tự động cho tất cả các cấp
\setcounter{tocdepth}{3}
\makeatletter
\newcounter {subsubsubsection}[subsubsection]
\renewcommand\thesubsubsubsection{\thesubsubsection .\@alph\c@subsubsubsection}
\newcommand\subsubsubsection{\@startsection{subsubsubsection}{4}{\z@}%
{-3.25ex\@plus -1ex \@minus -.2ex}%
{1.5ex \@plus .2ex}%
{\normalfont\normalsize\bfseries}}
\newcommand*\l@subsubsubsection{\@dottedtocline{3}{10.0em}{4.1em}}
\newcommand*{\subsubsubsectionmark}[1]{}
\makeatother

\definecolor{dkgreen}{rgb}{0,0.6,0}
\definecolor{gray}{rgb}{0.5,0.5,0.5}
\definecolor{mauve}{rgb}{0.58,0,0.82}

\lstset{frame=tb,
    language=Java, % Changed to Java for Backend tests, can be changed to JavaScript
    aboveskip=3mm,
    belowskip=3mm,
    showstringspaces=false,
    columns=flexible,
    basicstyle={\small\ttfamily},
    numbers=none,
    numberstyle=\tiny\color{gray},
    keywordstyle=\color{blue},
    commentstyle=\color{dkgreen},
    stringstyle=\color{mauve},
    breaklines=true,
    breakatwhitespace=true,
    tabsize=3,
    numbers=left,
    stepnumber=1,
    numbersep=1pt,
    firstnumber=1,
    numberfirstline=true
}

\begin{document}

    \begin{titlepage}
        \begin{center}
            TRƯỜNG ĐẠI HỌC SÀI GÒN \\
            KHOA CÔNG NGHỆ THÔNG TIN
        \end{center}

        \vspace{0.5cm}

        \begin{center}
            \includegraphics[width=3.5cm]{logoITSGU.png}
        \end{center}

        \vspace{1cm}

        \begin{center}
% Sử dụng tabularx hoặc đơn giản là tabular thường nhưng bỏ multicolumn thừa
            \begin{tabular}{c}
                \multicolumn{1}{c}{\textbf{{\Huge KIỂM THỬ PHẦN MỀM}}}\\
                \\
                \hline
                \\
                \textbf{{\Large MÔN:}}\\ % Thêm dòng này cho rõ nghĩa (tùy chọn)
                \textbf{{\huge Ứng dụng Đăng nhập \& Quản lý Sản phẩm}}\\
                \textbf{{\Large (Login \& Product Management - Version 1.0)}}\\
                \\
                \hline
            \end{tabular}
        \end{center}

        \vspace{2cm}

% --- PHẦN SỬA LỖI CANH LỀ ---
        \begin{table}[h]
            \centering
% Dùng 2 cột: r (right - canh phải cho nhãn) và l (left - canh trái cho tên)
            \begin{tabular}{rl}
                \textbf{GVHD:} & Từ Lãng Phiêu \\
                \textbf{NHÓM:} & 2 \\
                \textbf{SV:}   & Nguyễn Thanh Hiền - 3123560024 \\
                & Nhan Chí Phong - 3123560062 \\
                & Hoàng Đình Phú Quý - 3123560074 \\
                & Nguyễn Việt Hoàng - 3122560022 \\
                & Nguyễn Thành An - 3122410003 \\
            \end{tabular}
        \end{table}
% ----------------------------

        \vspace{2cm}
        \begin{center}
        {\footnotesize TP. HỒ CHÍ MINH, THÁNG 11/2025}
        \end{center}

    \end{titlepage}

    \newpage
    \begin{center}
        \large\textbf{LỜI CẢM ƠN}
    \end{center}

    Chúng em xin gửi lời cảm ơn chân thành đến Thầy Từ Lãng Phiêu, người đã tận tình hướng dẫn và truyền đạt những kiến thức quý báu về Kiểm thử phần mềm, quy trình TDD và các kỹ thuật kiểm thử hiện đại.

    Bài tập lớn này là cơ hội để chúng em áp dụng lý thuyết vào thực tế, từ việc phân tích test cases, viết unit test, integration test cho đến thiết lập quy trình CI/CD tự động.

    Dù đã cố gắng hết sức, báo cáo chắc chắn không tránh khỏi những thiếu sót. Chúng em rất mong nhận được sự góp ý của Thầy để hoàn thiện hơn.

    \begin{flushright}
        Thành phố Hồ Chí Minh, ngày 11 tháng 11 năm 2025
    \end{flushright}
    \newpage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    \newpage
    \tableofcontents
    \newpage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    \section{GIỚI THIỆU DỰ ÁN}

    \subsection{Tổng quan}
    Dự án \textbf{FloginFE\_BE} là một ứng dụng web full-stack được phát triển để thực hành các kỹ thuật kiểm thử phần mềm. Hệ thống bao gồm các chức năng chính:
    \begin{itemize}
        \item \textbf{Login:} Hệ thống đăng nhập bảo mật với validation chặt chẽ.
        \item \textbf{Product Management:} Quản lý sản phẩm với đầy đủ các thao tác CRUD (Create, Read, Update, Delete).
    \end{itemize}

    \subsection{Công nghệ sử dụng}
    \begin{itemize}
        \item \textbf{Frontend:} React 18+, Jest, React Testing Library.
        \item \textbf{Backend:} Spring Boot 3.2+, JUnit 5, Mockito.
        \item \textbf{Database:} MySQL / H2 Database.
        \item \textbf{CI/CD:} GitHub Actions.
    \end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    \newpage

\section{CÂU 1: PHÂN TÍCH VÀ THIẾT KẾ TEST CASES}

\subsection{Câu 1.1: Login - Phân tích và Test Scenarios (10 điểm)}

\subsubsection{Yêu cầu (5 điểm)}

\paragraph{a) Phân tích yêu cầu chức năng Login (2 điểm)}

\textbf{Validation rules cho username:}
\begin{itemize}
\item Độ dài: 3-50 ký tự
\item Định dạng cho phép: chữ cái (a-z, A-Z), số (0-9), và các ký tự -, ., \_
\item Không chấp nhận: khoảng trắng, kí tự đặc biệt khác, icon
\end{itemize}

\textbf{Validation rules cho password:}
\begin{itemize}
\item Độ dài: 6-100 ký tự
\item Phải chứa ít nhất 1 chữ cái và 1 số
\item Có thể chứa ký tự đặc biệt (không được quy định cấm)
\end{itemize}

\textbf{Authentication flow:}
\begin{itemize}
\item Người dùng nhập username và password
\item Hệ thống validate định dạng input
\item Nếu validation thất bại → hiển thị thông báo định dạng đúng
\item Nếu validation thành công → kiểm tra thông tin trong database
\item Nếu thông tin khớp → tạo session/chuyển hướng đến trang chủ
\item Nếu không khớp → hiển thị thông báo lỗi
\end{itemize}

\textbf{Error handling:}
\begin{itemize}
\item Hiển thị thông báo lỗi cụ thể cho từng trường hợp (server phản hồi)
\item Giữ nguyên giá trị đã nhập (trừ password)
\item Log lỗi cho mục đích bảo mật và debugging
\end{itemize}

\paragraph{b) Test Scenarios cho Login (2 điểm)}

\begin{enumerate}
\item \textbf{Happy Path:} Đăng nhập thành công
  \begin{itemize}
  \item Input: Username: "user123", Password: "pass123"
  \item Expected: Đăng nhập thành công, chuyển hướng đến trang chủ
  \end{itemize}

\item \textbf{Negative Test:} Username rỗng
  \begin{itemize}
  \item Input: Username: "", Password: "123@sgu\_testing"
  \item Expected: Hiển thị lỗi "Username không được để trống"
  \end{itemize}

\item \textbf{Negative Test:} Password rỗng
  \begin{itemize}
  \item Input: Username: "user123", Password: ""
  \item Expected: Hiển thị lỗi "Mật khẩu không được để trống"
  \end{itemize}

\item \textbf{Negative Test:} Sai username/password
  \begin{itemize}
  \item Input: Username: "wronguser", Password: "wrongpass"
  \item Expected: Hiển thị lỗi "Thông tin đăng nhập không chính xác"
  \end{itemize}

\item \textbf{Boundary Test:} Username đạt min length
  \begin{itemize}
  \item Input: Username: "abc", Password: "pass123"
  \item Expected: Đăng nhập thành công
  \end{itemize}

\item \textbf{Boundary Test:} Username đạt max length
  \begin{itemize}
  \item Input: Username: "a"*50, Password: "pass123"
  \item Expected: Đăng nhập thành công
  \end{itemize}

\item \textbf{Boundary Test:} Password đạt min length
  \begin{itemize}
  \item Input: Username: "user123", Password: "abc123"
  \item Expected: Đăng nhập thành công
  \end{itemize}

\item \textbf{Boundary Test:} Password đạt max length
  \begin{itemize}
  \item Input: Username: "user123", Password: "a"*99 + "1"
  \item Expected: Đăng nhập thành công
  \end{itemize}

\item \textbf{Edge Case:} Username chứa ký tự không hợp lệ
  \begin{itemize}
  \item Input: Username: "user@123!", Password: "pass123"
  \item Expected: Hiển thị lỗi "Username chỉ được chứa chữ cái, số và ký tự -.\_"
  \end{itemize}

\item \textbf{Edge Case:} Password chỉ chứa chữ (thiếu số)
  \begin{itemize}
  \item Input: Username: "user123", Password: "test"
  \item Expected: Hiển thị lỗi "Mật khẩu phải chứa ít nhất 1 chữ cái và 1 số"
  \end{itemize}

\item \textbf{Security Test:} SQL Injection attack
  \begin{itemize}
  \item Input: Username: admin' OR '1'='1'--, Password: anything
  \item Expected: Hiển thị thông báo lỗi "Thông tin đăng nhập không chính xác", KHÔNG tiết lộ thông tin lỗi database, hệ thống không bị crash hoặc bypass authentication
  \end{itemize}

\item \textbf{Security Test:} XSS Script Injection
  \begin{itemize}
  \item Input: Username: <script>alert('hello')</script>, Password: password123
  \item Expected: Hiển thị lỗi validation "Username chỉ được chứa chữ cái, số và ký tự -.\_", Script không được thực thi trên trình duyệt
  \end{itemize}
\end{enumerate}

\paragraph{c) Phân loại ưu tiên test scenarios (1 điểm)}

\begin{itemize}
\item \textbf{Critical (Rất quan trọng):} Scenario 1, 2, 3, 4, 11, 12
\item \textbf{High (Cao):} Scenario 5, 6, 9
\item \textbf{Medium (Trung bình):} Scenario 7, 8
\item \textbf{Low (Thấp):} Scenario 10
\end{itemize}

\textbf{Giải thích:}
\begin{itemize}
\item Critical: Các scenario ảnh hưởng trực tiếp đến khả năng sử dụng hệ thống và bảo mật
\item High: Các scenario liên quan đến core validation rules của username
\item Medium: Các scenario về password validation, ít xảy ra hơn trong thực tế
\item Low: Các trường hợp edge case ít gặp, ưu tiên thấp hơn
\end{itemize}

\subsubsection{Thiết kế Test Cases chi tiết (5 điểm)}
% ================== LOGIN TEST CASES ==================
\begin{table}[htbp]
\small
\centering
\begin{tabular}{|>{\arraybackslash}p{4cm}|p{10cm}|}
\hline
\textbf{Test Case ID} & TC\_LOGIN\_001 \\ \hline
\textbf{Test Name} & Đăng nhập thành công với credentials hợp lệ \\ \hline
\textbf{Priority} & Quan trọng \\ \hline
\textbf{Preconditions} & 
\begin{itemize}[leftmargin=*,noitemsep]
\item Tài khoản tồn tại trong hệ thống
\item Ứng dụng đang chạy
\end{itemize} \\ \hline
\textbf{Test Steps} & 
\begin{enumerate}[leftmargin=*,noitemsep]
\item Vào trang login
\item Nhập username
\item Nhập password
\item Click nút Login 
\end{enumerate} \\ \hline
\textbf{Test Data} & Username: admin123 \newline Password: admin123 \\ \hline
\textbf{Expected Result} & 
\begin{itemize}[leftmargin=*,noitemsep]
\item Hiển thị welcome message
\item Token/Session được lưu
\item Chuyển hướng đến trang quản lý sản phẩm
\end{itemize} \\ \hline
\textbf{Actual Result} & (Để trống) \\ \hline
\textbf{Status} & Not Run \\ \hline
\end{tabular}
\caption{Test Case Đăng nhập thành công}
\end{table}

\begin{table}[htbp]
\small
\centering
\begin{tabular}{|p{2.8cm}|p{10.2cm}|}
\hline
\textbf{Test Case ID} & TC\_LOGIN\_002 \\ \hline
\textbf{Test Name} & Đăng nhập thất bại khi username rỗng \\ \hline
\textbf{Priority} & Quan trọng \\ \hline
\textbf{Preconditions} & Ứng dụng đang chạy \\ \hline
\textbf{Test Steps} & 
\begin{enumerate}[leftmargin=*,noitemsep]
\item Vào trang login
\item Không nhập username
\item Nhập password
\item Click nút Login
\end{enumerate} \\ \hline
\textbf{Test Data} & Username: (rỗng) \newline Password: Test123 \\ \hline
\textbf{Expected Result} & 
\begin{itemize}[leftmargin=*,noitemsep]
\item Hiển thị thông báo lỗi: ``Username không được để trống''
\item Vẫn ở trang login
\item Không tạo session/token
\end{itemize} \\ \hline
\textbf{Actual Result} & (Để trống) \\ \hline
\textbf{Status} & Not Run \\ \hline
\end{tabular}
\caption{Test Case Đăng nhập thất bại khi username rỗng}
\end{table}


\begin{table}[htbp]
\small
\centering
\begin{tabular}{|p{2.8cm}|p{10.2cm}|}
\hline
\textbf{Test Case ID} & TC\_LOGIN\_003 \\ \hline
\textbf{Test Name} & Đăng nhập thất bại Password rỗng \\ \hline
\textbf{Priority} & Quan trọng \\ \hline
\textbf{Preconditions} & Ứng dụng đang chạy, đang ở trang login \\ \hline
\textbf{Test Steps} & 
\begin{enumerate}[leftmargin=*,noitemsep]
\item Vào trang login
\item Nhập username đúng định dạng
\item Không nhập  password
\item Click nút Login
\end{enumerate} \\ \hline
\textbf{Test Data} & Username: admin123 \newline Password\\ \hline
\textbf{Expected Result} & 
\begin{itemize}[leftmargin=*,noitemsep]
\item Hiển thị thông báo lỗi: "Password không được để trống"
\item Vẫn ở trang login
\item Không tạo session/token
\end{itemize} \\ \hline
\textbf{Actual Result} & (Để trống) \\ \hline
\textbf{Status} & Not Run \\ \hline
\end{tabular}
\caption{Test Case đăng nhập thất bại khi password rỗng}
\end{table}

\begin{table}[htbp]
\small
\centering
\begin{tabular}{|p{2.8cm}|p{10.2cm}|}
\hline
\textbf{Test Case ID} & TC\_LOGIN\_004 \\ \hline
\textbf{Test Name} & Đăng nhập thất bại khi password chỉ chứa chữ \\ \hline
\textbf{Priority} & Cao \\ \hline
\textbf{Preconditions} & Ứng dụng đang chạy \\ \hline
\textbf{Test Steps} & 
\begin{enumerate}[leftmargin=*,noitemsep]
\item Vào trang login
\item Nhập username
\item Nhập password sai định dạng
\item Click nút Login
\end{enumerate} \\ \hline
\textbf{Test Data} & Username: testuser \newline Password: password \\ \hline
\textbf{Expected Result} & 
\begin{itemize}[leftmargin=*,noitemsep]
\item Hiển thị thông báo lỗi: ``Mật khẩu phải chứa ít nhất 1 chữ cái và 1 số''
\item Vẫn ở trang login
\item Giữ username, reset input password
\end{itemize} \\ \hline
\textbf{Actual Result} & (Để trống) \\ \hline
\textbf{Status} & Not Run \\ \hline
\end{tabular}
\caption{Test Case Đăng nhập thất bại khi password chỉ chứa chữ}
\end{table}


\begin{table}[htbp]
\small
\centering
\begin{tabular}{|p{2.8cm}|p{10.2cm}|}
\hline
\textbf{Test Case ID} & TC\_LOGIN\_005 \\ \hline
\textbf{Test Name} & Đăng nhập thất bại khi username > 50 ký tự \\ \hline
\textbf{Priority} & Trung bình \\ \hline
\textbf{Preconditions} & Ứng dụng đang chạy \\ \hline
\textbf{Test Steps} & 
\begin{enumerate}[leftmargin=*,noitemsep]
\item Vào trang login
\item Nhập username > 50 ký tự
\item Nhập password
\item Click nút Login
\end{enumerate} \\ \hline
\textbf{Test Data} & Username:abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxy \newline Password: Test123 \\ \hline
\textbf{Expected Result} & 
\begin{itemize}[leftmargin=*,noitemsep]
\item Hiển thị lỗi: ``Username chỉ được phép từ 3-50 ký tự''
\item Không gửi request đến server (client-side validation)
\end{itemize} \\ \hline
\textbf{Actual Result} & (Để trống) \\ \hline
\textbf{Status} & Not Run \\ \hline
\end{tabular}
\caption{Test Case Đăng nhập thất bại khi username quá dài}
\end{table}
\FloatBarrier
\subsection{Câu 1.2: Product - Phân tích và Test Scenarios (10 điểm)}

\subsubsection{Yêu cầu (5 điểm)}

\paragraph{a) Phân tích yêu cầu chức năng Product CRUD (2 điểm)}

\textbf{Create - Thêm sản phẩm mới:}
\begin{itemize}
\item \textbf{Validation Rules:}
  \begin{itemize}
  \item Product Name: 3-100 ký tự, bắt buộc, không trùng
  \item Price: 0 -> 999.999.999
  \item Quantity: số nguyên dương
  \item Description: ≤ 500 ký tự, có thể để trống
  \item Category: Phải chọn từ danh sách có sẵn
  \end{itemize}
\item \textbf{Business Logic:}
  \begin{itemize}
  \item Tạo mã sản phẩm tự động (nếu có)
  \item Kiểm tra trùng tên sản phẩm
  \item Tính toán tồn kho ban đầu
  \item Log hoạt động tạo sản phẩm
  \end{itemize}
\end{itemize}

\textbf{Read - Xem danh sách/chi tiết sản phẩm:}
\begin{itemize}
\item \textbf{Danh sách sản phẩm:}
  \begin{itemize}
  \item Pagination, sorting, filtering theo category
  \item Search theo tên sản phẩm
  \item Hiển thị thông tin cơ bản: tên, giá, số lượng
  \end{itemize}
\item \textbf{Chi tiết sản phẩm:}
  \begin{itemize}
  \item Hiển thị đầy đủ thông tin sản phẩm
  \item Hiển thị ngày tạo, ngày cập nhật
  \item Ảnh sản phẩm (nếu có)
  \end{itemize}
\end{itemize}

\textbf{Update - Cập nhật thông tin sản phẩm:}
\begin{itemize}
\item \textbf{Validation:} Tương tự Create
\item \textbf{Business Logic:}
  \begin{itemize}
  \item Cho phép cập nhật tất cả trường (trừ ID)
  \item Kiểm tra trùng tên (loại trừ chính nó)
  \item Cập nhật ngày sửa đổi
  \item Log lịch sử thay đổi
  \end{itemize}
\end{itemize}

\textbf{Delete - Xóa sản phẩm:}
\begin{itemize}
\item \textbf{Validation:}
  \begin{itemize}
  \item Sản phẩm phải tồn tại
  \item Kiểm tra ràng buộc (có đơn hàng liên quan không)
  \end{itemize}
\item \textbf{Business Logic:}
  \begin{itemize}
  \item Soft delete (khuyến nghị) hoặc hard delete
  \item Xóa ảnh, file đính kèm (nếu có)
  \item Log hoạt động xóa
  \end{itemize}
\end{itemize}

\paragraph{b) Test Scenarios cho Product (2 điểm)}

\begin{enumerate}
\item \textbf{Happy Path:} Tạo sản phẩm mới thành công
  \begin{itemize}
  \item Input: Dữ liệu hợp lệ đầy đủ
  \item Expected: Tạo thành công, hiển thị message, xuất hiện trong danh sách
  \end{itemize}

\item \textbf{Happy Path:} Xem chi tiết sản phẩm thành công
  \begin{itemize}
  \item Input: ID sản phẩm hợp lệ
  \item Expected: Hiển thị đầy đủ thông tin sản phẩm
  \end{itemize}

\item \textbf{Happy Path:} Cập nhật sản phẩm thành công
  \begin{itemize}
  \item Input: Dữ liệu mới hợp lệ
  \item Expected: Cập nhật thành công, thông tin thay đổi được lưu
  \end{itemize}

\item \textbf{Happy Path:} Xóa sản phẩm thành công
  \begin{itemize}
  \item Input: ID sản phẩm hợp lệ, không có ràng buộc
  \item Expected: Xóa thành công, sản phẩm biến mất khỏi danh sách
  \end{itemize}

\item \textbf{Negative Test:} Tạo sản phẩm thất bại - Tên trùng
  \begin{itemize}
  \item Input: Tên sản phẩm đã tồn tại
  \item Expected: Hiển thị lỗi "Tên sản phẩm đã tồn tại"
  \end{itemize}

\item \textbf{Negative Test:} Tạo sản phẩm thất bại - Giá âm
  \begin{itemize}
  \item Input: Price = -1000
  \item Expected: Hiển thị lỗi "Giá phải lớn hơn 0"
  \end{itemize}

\item \textbf{Negative Test:} Cập nhật thất bại - Category không tồn tại
  \begin{itemize}
  \item Input: Category không có trong danh sách
  \item Expected: Hiển thị lỗi "Danh mục không hợp lệ"
  \end{itemize}

\item \textbf{Boundary Test:} Tạo sản phẩm - Tên đạt min length
  \begin{itemize}
  \item Input: Product Name = "ABC" (3 ký tự)
  \item Expected: Tạo thành công
  \end{itemize}

\item \textbf{Boundary Test:} Tạo sản phẩm - Price đạt max value
  \begin{itemize}
  \item Input: Price = 999,999,999
  \item Expected: Tạo thành công
  \end{itemize}

\item \textbf{Edge Case:} Xóa sản phẩm không tồn tại
  \begin{itemize}
  \item Input: ID sản phẩm không tồn tại
  \item Expected: Hiển thị lỗi "Sản phẩm không tồn tại"
  \end{itemize}
\end{enumerate}

\paragraph{c) Phân loại ưu tiên test scenarios (1 điểm)}

\begin{itemize}
\item \textbf{Critical (Rất quan trọng):} Scenario 1, 5, 6
\item \textbf{High (Cao):} Scenario 3, 4, 7
\item \textbf{Medium (Trung bình):} Scenario 2, 8, 9
\item \textbf{Low (Thấp):} Scenario 10
\end{itemize}

\textbf{Giải thích:}
\begin{itemize}
\item Critical: Các scenario ảnh hưởng trực tiếp đến business logic và data integrity
\item High: Các chức năng core CRUD và validation quan trọng
\item Medium: Các chức năng cơ bản và boundary tests
\item Low: Edge case ít xảy ra trong thực tế
\end{itemize}

\subsubsection{Thiết kế Test Cases chi tiết (5 điểm)}

\begin{table}[h]
\centering
\begin{tabular}{|p{3cm}|p{10cm}|}
\hline
\textbf{Test Case ID} & TC\_PRODUCT\_001 \\
\hline
\textbf{Test Name} & Tạo sản phẩm mới thành công \\
\hline
\textbf{Priority} & Quan trọng \\
\hline
\textbf{Preconditions} & User đã đăng nhập \\ 
                       & User có quyền tạo sản phẩm \\
                       & Danh mục "Electronics" tồn tại \\
\hline
\textbf{Test Steps} & 1. Chuyển đến trang quản lý sản phẩm \\
                    & 2. Click thêm sản phẩm \\
                    & 3. Nhập thông tin theo mẫu \\
                    & 4. Click nút lưu \\
\hline
\textbf{Test Data} & - Name: Laptop Dell XPS 13 \\
                   & - Price: 15000000 \\
                   & - Quantity: 10 \\
                   & - Category: Electronics \\
                   & - Description: Laptop cao cấp cho doanh nhân \\
\hline
\textbf{Expected Result} & - Hiển thị thông báo "thêm sản phẩm thành công" \\
                         & - Hiển thị sản phẩm mới trong danh sách sản phẩm \\
\hline
\textbf{Actual Result} & (Để trống) \\
\hline
\textbf{Status} & Not Run \\
\hline
\end{tabular}
\caption{Test Case Tạo sản phẩm thành công}
\end{table}

\begin{table}[h]
\centering
\begin{tabular}{|p{3cm}|p{10cm}|}
\hline
\textbf{Test Case ID} & TC\_PRODUCT\_002 \\
\hline
\textbf{Test Name} & Cập nhật thông tin sản phẩm thành công \\
\hline
\textbf{Priority} & Cao \\
\hline
\textbf{Preconditions} & User đã đăng nhập \\
                       & User có quyền chỉnh sửa sản phẩm \\
                       & Sản phẩm "Laptop Dell XPS 13" tồn tại \\
                       & Danh mục "Laptop" tồn tại \\
\hline
\textbf{Test Steps} & 1. Chuyển đến trang quản lý sản phẩm \\
                    & 2. Click vào button sửa ở dòng sản phẩm "Laptop Dell XPS 13" \\
                    & 3. Cập nhật thông tin sản phẩm \\
                    & 4. Click nút lưu \\
\hline
\textbf{Test Data} & Name: Laptop Dell XPS 13 (2024) \\
                   & Price: 16000000 \\
                   & Quantity: 15 \\
                   & Category: Laptop \\
                   & Description: Laptop cao cấp phiên bản 2024 \\
\hline
\textbf{Expected Result} & - Hiển thị thông báo "Cập nhật sản phẩm thành công" \\
                         & - Hiển thị thông tin mới của sản phẩm trong danh sách sản phẩm \\
\hline
\textbf{Actual Result} & (Để trống) \\
\hline
\textbf{Status} & Not Run \\
\hline
\end{tabular}
\caption{Test Case Cập nhật sản phẩm thành công}
\end{table}

\begin{table}[h]
\centering
\begin{tabular}{|p{3cm}|p{10cm}|}
\hline
\textbf{Test Case ID} & TC\_PRODUCT\_003 \\
\hline
\textbf{Test Name} & Xóa sản phẩm thành công \\
\hline
\textbf{Priority} & Cao \\
\hline
\textbf{Preconditions} & User đã đăng nhập \\
                       & User có quyền xóa sản phẩm \\
                       & Sản phẩm "Test Product For Delete" tồn tại \\
                       & Sản phẩm không có đơn hàng liên quan \\
\hline
\textbf{Test Steps} & 1. Chuyển đến trang quản lý sản phẩm \\
                    & 2. Click vào button xóa ở dòng sản phẩm "Test Product For Delete" \\
                    & 3. Xác nhận xóa trong confirmation dialog \\
\hline
\textbf{Test Data} & Product Name: Test Product For Delete \\
\hline
\textbf{Expected Result} & - Hiển thị confirmation dialog \\
                         & - Sau khi confirm, hiển thị message: "Xóa sản phẩm thành công" \\
                         & - Sản phẩm biến mất khỏi danh sách \\
                         & - Không thể tìm thấy sản phẩm bằng search \\
\hline
\textbf{Actual Result} & (Để trống) \\
\hline
\textbf{Status} & Not Run \\
\hline
\end{tabular}
\caption{Test Case Xóa sản phẩm thành công}
\end{table}

\begin{table}[h]
\centering
\begin{tabular}{|p{3cm}|p{10cm}|}
\hline
\textbf{Test Case ID} & TC\_PRODUCT\_004 \\
\hline
\textbf{Test Name} & Xem danh sách sản phẩm \\
\hline
\textbf{Priority} & Cao \\
\hline
\textbf{Preconditions} & User đã đăng nhập \\ 
&Có ít nhất 1 sản phẩm trong hệ thống \\
\hline
\textbf{Test Steps} & 1. Chuyển đến trang quản lý sản phẩm \\
\hline
\textbf{Test Data} & (trống) \\
\hline
\textbf{Expected Result} & Hiển thị danh sách sản phẩm với đầy đủ thông tin \\
\hline
\textbf{Actual Result} & (Để trống) \\
\hline
\textbf{Status} & Not Run \\
\hline
\end{tabular}
\caption{Test Case Xem danh sách sản phẩm}
\end{table}

\begin{table}[h]
\centering
\begin{tabular}{|p{3cm}|p{10cm}|}
\hline
\textbf{Test Case ID} & TC\_PRODUCT\_005 \\
\hline
\textbf{Test Name} & Tạo sản phẩm thất bại do trùng tên \\
\hline
\textbf{Priority} & Quan trọng \\
\hline
\textbf{Preconditions} & User đã đăng nhập \\ 
& User có quyền tạo sản phẩm \\ 
&Sản phẩm "Laptop Dell XPS 13" đã tồn tại \\
\hline
\textbf{Test Steps} & 1. Chuyển đến trang quản lý sản phẩm \\
                    & 2. Click thêm sản phẩm \\
                    & 3. Nhập tên trùng và các thông tin theo mẫu \\
                    & 4. Click nút lưu \\
\hline
\textbf{Test Data} & Name: Laptop Dell XPS 13 (trùng), Price: 15000000, Quantity: 5, Category: Electronics, Description: Sản phẩm mô tả mới \\
\hline
\textbf{Expected Result} & - Hiển thị lỗi: "Tên sản phẩm đã tồn tại" \\
                         & - Form không được submit \\
                         & - Vẫn ở trang tạo sản phẩm \\
                         & - Các field khác giữ nguyên giá trị đã nhập \\
\hline
\textbf{Actual Result} & (Để trống) \\
\hline
\textbf{Status} & Not Run \\
\hline
\end{tabular}
\caption{Test Case Tạo sản phẩm thất bại do trùng tên}
\end{table}
    \FloatBarrier
\clearpage
    
    \section{CÂU 2: UNIT TESTING VÀ TDD}

    \subsection{2.1. Frontend Unit Tests (React/Jest)}
    Áp dụng TDD để viết test cho module validation.
    \begin{lstlisting}[language=JavaScript, caption={Validation Unit Test}]
import { validateUsername } from './validation';

describe('Login Validation Tests', () => {
  test('TC1: Username rong - tra ve loi', () => {
    expect(validateUsername('')).toBe('Ten dang nhap khong duoc de trong');
  });

  test('TC2: Username hop le', () => {
    expect(validateUsername('user123')).toBe('');
  });
});
    \end{lstlisting}

    \subsection{2.2. Backend Unit Tests (JUnit 5)}
    Test `AuthService` và `ProductService`.
    \begin{lstlisting}[language=Java, caption={AuthService Unit Test}]
@DisplayName("Login Service Unit Tests")
class AuthServiceTest {
    @Test
    @DisplayName("Login thanh cong")
    void testLoginSuccess() {
        LoginRequest req = new LoginRequest("testuser", "Test123");
        LoginResponse res = authService.authenticate(req);
        assertTrue(res.isSuccess());
        assertNotNull(res.getToken());
    }
}
    \end{lstlisting}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    \newpage
    \section{CÂU 3: INTEGRATION TESTING}

    \subsection{3.1. Backend API Integration}
    Sử dụng `MockMvc` để test các endpoint API.

    \begin{lstlisting}[language=Java, caption={ProductController Integration Test}]
@WebMvcTest(ProductController.class)
class ProductControllerTest {
    @Autowired private MockMvc mockMvc;

    @Test
    void testGetAllProducts() throws Exception {
        mockMvc.perform(get("/products"))
               .andExpect(status().isOk())
               .andExpect(jsonPath("$", hasSize(2)));
    }
}
    \end{lstlisting}

    \subsection{3.2. Frontend Component Integration}
    Sử dụng `React Testing Library` để render component và tương tác như người dùng thật.
    \begin{itemize}
        \item Kiểm tra việc render form Login.
        \item Giả lập sự kiện click nút "Login" và kiểm tra hàm gọi API.
        \item Kiểm tra hiển thị thông báo lỗi khi API trả về 401.
    \end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    \newpage
    \section{CÂU 4: MOCK TESTING}

    \subsection{Mục đích}
    Cô lập unit cần test bằng cách giả lập (mock) các dependencies bên ngoài (Database, External Services).

    \subsection{Triển khai}
    \begin{itemize}
        \item \textbf{Frontend:} Sử dụng `jest.mock` để mock `axios` hoặc `authService`.
        \item \textbf{Backend:} Sử dụng `@MockBean` để mock `ProductRepository` bên trong `ProductServiceTest`.
    \end{itemize}

    \begin{lstlisting}[language=Java, caption={Mocking Repository}]
@Test
void testCreateProduct() {
    Product product = new Product("Laptop", 15000000);
    when(productRepository.save(any())).thenReturn(product);

    ProductDto result = productService.createProduct(new ProductDto("Laptop", ...));

    verify(productRepository, times(1)).save(any());
    assertEquals("Laptop", result.getName());
}
    \end{lstlisting}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    \newpage
    \section{CÂU 5: AUTOMATION TESTING VÀ CI/CD}

    \subsection{5.1. E2E Testing với Cypress}
    a) Thiết lập Page Object Model (POM) để test luồng người dùng.
    \begin{lstlisting}[language=Java, caption={Cypress E2E Login Test}]
describe('Login E2E Tests', () => {
  beforeEach(() => {
    cy.visit('http://localhost:3000');
  })
  it('Nen hien thi form login', () => {
    cy.visit("/")
    cy.get('[data-testid="username-input"]').should('be.visible')
    cy.get('[data-testid="password-input"]').should('be.visible')
    cy.get('[data-testid="login-button"]').should('be.visible')
  })
  it('Nen login thanh cong voi credentials hop le', () => {
    cy.visit("/")
    // chan mock do be goi db that
    cy.intercept('POST', 'auth/login', {
      statusCode: 200,
      body:{
        accessToken: "fake_jwt_token", header: "Bearer"
      }
    }).as("loginRequest")
    cy.get('[data-testid="username-input"]').type('admin123')
    cy.get('[data-testid="password-input"]').type('admin123')
    cy.get('[data-testid="login-button"]').click()

    cy.get('[data-testid="login-success"]').should('contain', 'Success')
    cy.url().should('include', '/admin/products')
  })
  it('Nen hien thi loi voi credentials khong hop le', () => {
    cy.visit("/")
    cy.get('[data-testid="username-input"]').type('ab')
    cy.get('[data-testid="password-input"]').type('1234')
    cy.get('[data-testid="login-button"]').click()

    cy.get('[data-testid="username-error"]').should('be.visible')
  })
})
    \end{lstlisting}
    b) CI/CD Integration cho Login Tests
    \begin{lstlisting}[language=XML, caption={CI/CD Integration cho Login Tests}]
name: Login Tests CI
on:
  push:
    branches: [main, develop]
  pull_request:
    branches: [main]
jobs:
  test-login:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Setup Node.js
        uses: actions/setup-node@v2
        with:
          node-version: '24'

      - name: Install dependencies
        run: |
          cd FloginFE_BE/frontend
          npm install

      - name: Start Frontend
        run: |
          cd FloginFE_BE/frontend
          npm start &
      - name: Run Login E2E Tests
        run: |
          cd FloginFE_BE/frontend
          npm run test:e2e -- --spec "cypress/e2e/login.e2e.cy.js"
    \end{lstlisting}

    \subsection{5.2. Product - E2E Automation Testing}
    a) Setup Page Object Model
    \begin{lstlisting}[language=Java, caption={ProductPage.js}]

class ProductPage {
    constructor() {
        this.currentProduct = null;
        this.products = [];
        this.productIdCounter = 3;
    }

    setupIntercepts() {
        cy.intercept('GET', '/products',(req) => {
            req.reply({
                statusCode: 200,
                body: this.products
            });
        }).as('getProducts');
    }

    clickAddNew() {
        cy.get('[data-testid="add-product-btn"]').click()
    }

    fillProductForm(product, isEdit = false) {
        this.currentProduct = product;
        if (isEdit) {
            if (product.name) {
                cy.get('[data-testid="product-name"]').clear().type(product.name);
            }
            if (product.price) {
                cy.get('[data-testid="product-price"]').clear().type(product.price);
            }
            if (product.quantity) {
                cy.get('[data-testid="product-quantity"]').clear().type(product.quantity);
            }
            if (product.categoryId) {
                cy.get('[data-testid="product-category"]').should('be.visible').select(String(product.categoryId));
            }
            if (product.description) {
                cy.get('[data-testid="product-description"]').clear().type(product.description);
            }
        } else {
            if (product.name) cy.get('[data-testid="product-name"]').type(product.name);
            if (product.price) cy.get('[data-testid="product-price"]').type(product.price);
            if (product.quantity) cy.get('[data-testid="product-quantity"]').type(product.quantity);
            if (product.categoryId) cy.get('[data-testid="product-category"]').should('be.visible').select(String(product.categoryId));
            if (product.description) cy.get('[data-testid="product-description"]').type(product.description);
        }
    }

    clickEditProduct(productName) {
        this.getProductInList(productName).within(() => {
            cy.get('[data-testid="edit-product-btn"]').click();
        });
    }

    clickDeleteProduct(productName) {
        this.getProductInList(productName).within(() => {
            cy.get('[data-testid="delete-product-btn"]').click();
        });
    }

    submitForm() {
        if (!this.currentProduct){
            throw new Error("No product data filled. Call fillProductForm first!");
        }

        const newProduct = {
            id: this.productIdCounter++,
            productName: this.currentProduct.name,
            price: parseInt(this.currentProduct.price),
            quantity: parseInt(this.currentProduct.quantity),
            description: this.currentProduct.description,
            category: { name: "Laptop" }
        };

        this.products.push(newProduct);

        cy.intercept('POST', '/products', {
            statusCode: 200,
            body: newProduct
        }).as("addProduct");

        cy.intercept('GET', '/products', (req) => {
            req.reply({
                statusCode: 200,
                body: this.products
            });
        }).as('getProductsAfterAdd');

        cy.get('[data-testid="submit-btn"]').click();
        cy.wait('@addProduct').then(() => {
            cy.wait('@getProductsAfterAdd');
        });
    }

    submitEditForm() {
        if (!this.currentProduct){
            throw new Error("No product data filled. Call fillProductForm first!");
        }

        cy.intercept('PUT', '/products/**', (req) => {
            const updatedProduct = {};
            if (this.currentProduct.name) updatedProduct.productName = this.currentProduct.name;
            if (this.currentProduct.price) updatedProduct.price = parseInt(this.currentProduct.price);
            if (this.currentProduct.quantity) updatedProduct.quantity = parseInt(this.currentProduct.quantity);
            if (this.currentProduct.description) updatedProduct.description = this.currentProduct.description;
            if (this.currentProduct.categoryId) updatedProduct.category = { name: "Laptop" };

            const idMatch = req.url.match(/\/products\/(\d+)/);
            if (idMatch) {
                const productId = parseInt(idMatch[1]);
                const index = this.products.findIndex(p => p.id === productId);
                if (index !== -1) {
                    this.products[index] = { ...this.products[index], ...updatedProduct };
                }
            }

            req.reply({
                statusCode: 200,
                body: updatedProduct
            });
        }).as("updateProduct");

        // Reload products list after update
        cy.intercept('GET', '/products', (req) => {
            req.reply({
                statusCode: 200,
                body: this.products
            });
        }).as('getProductsAfterUpdate');

        cy.get('[data-testid="submit-btn"]').click();
        cy.wait('@updateProduct').then(() => {
            cy.wait('@getProductsAfterUpdate');
        });
    }

    confirmDelete() {
        cy.intercept('DELETE', '/products/**', (req) => {
            const idMatch = req.url.match(/\/products\/(\d+)/); //  URL goi api thi se co products/3 match tim theo url lay dc id product
            if (idMatch) {
                const productId = parseInt(idMatch[1]);
                this.products = this.products.filter(p => p.id !== productId);
            }

            req.reply({
                statusCode: 200
            });
        }).as("deleteProduct");

        cy.intercept('GET', '/products', (req) => {
            req.reply({
                statusCode: 200,
                body: this.products
            });
        }).as('getProductsAfterDelete');

        cy.get('[data-testid="confirm-delete-btn"]').click();
        cy.wait('@deleteProduct').then(() => {
            cy.wait('@getProductsAfterDelete');
        });
    }

    getSuccessMessage() {
        return cy.get('[data-testid="add-success"]')
    }

    getProductInList(name) {
        return cy.contains('[data-testid="product-item"]', name)
    }

}

export default ProductPage;
    \end{lstlisting}
    b) Automated tests cho CRUD operations
    \begin{lstlisting}[language=Java, caption={E2E Test Scenarios cho Product}]
import ProductPage from "./pages/ProductPage";


describe("Product E2E Tests", () => {
    const productPage = new ProductPage();

    beforeEach(() => {
        cy.login("admin123", "admin123");
        cy.fixture('products.json').then((data) => {
            productPage.products = [...data];
            productPage.productIdCounter = Math.max(...data.map(p => p.id)) + 1;
        });
        productPage.setupIntercepts();
    })

    it('Nen tao san pham moi thanh cong', () => {
        productPage.clickAddNew()
        productPage.fillProductForm({
            name: "Laptop Dell",
            price: '150000',
            quantity: "20",
            categoryId: "1",
            description: "Dell la laptop"
        })
        productPage.submitForm()
        productPage.getSuccessMessage().should('contain', 'Success')
        productPage.getProductInList("Laptop Dell").should('exist')
    })

    it('Nen cap nhat san pham thanh cong', () => {
        productPage.clickEditProduct("Pixel 4")

        cy.get('[data-testid="product-category"]').should('be.visible');

        cy.get('[data-testid="product-name"]').should('have.value', 'Pixel 4');
        cy.get('[data-testid="product-price"]').should('have.value', '36000');

        productPage.fillProductForm({
            price: '99000'
        }, true)

        productPage.submitEditForm()
        productPage.getProductInList("Pixel 4").should('exist')
        cy.contains('[data-testid="product-item"]', "Pixel 4").should('contain', '99.000')
    })

    it('Nen xoa san pham thanh cong', () => {
        productPage.clickDeleteProduct("Pixel 4")
        productPage.confirmDelete()
        cy.contains('[data-testid="product-item"]', "Pixel 4").should('not.exist')
    })
})
    \end{lstlisting}
    \subsection{5.3. CI/CD với GitHub Actions}
    Cấu hình workflow tự động chạy test khi có code mới được push lên nhánh `main`.

    \begin{lstlisting}[language=XML, caption={GitHub Actions Workflow}]
name: Complete CI/CD Pipeline

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main ]

jobs:
  build:
    runs-on: ubuntu-latest

    services:
      mysql:
        image: mysql:latest
        ports:
          - 3306:3306
        env:
          MYSQL_DATABASE: login-product
          MYSQL_PASSWORD: root

    steps:
      - uses: actions/checkout@v2

      - name: Setup Java
        uses: actions/setup-java@v2
        with:
          java-version: '21'
          distribution: 'temurin'

      - name: Setup Node.js
        uses: actions/setup-node@v2
        with:
          node-version: '24'

      - name: Backend Tests
        run: |
          cd FloginFE_BE/backend
          chmod +x ./mvnw
          ./mvnw clean test

      - name: Frontend Tests
        run: |
          cd FloginFE_BE/frontend
          npm install
          npm test -- --coverage

      - name: Start Frontend
        run: |
          cd FloginFE_BE/frontend
          npm start &

      - name: E2E Tests
        run: |
          cd FloginFE_BE/frontend

          npm run test:e2e

      - name: Upload Coverage
        uses: codecov/codecov-action@v2
        with:
          files: |
            FloginFE_BE/frontend/coverage/lcov.info
            FloginFE_BE/backend/target/site/jacoco/jacoco.xml

    \end{lstlisting}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    \newpage
    \section{PHẦN MỞ RỘNG (BONUS)}

    \subsection{7.1. Performance Testing}
    Theo yêu cầu của đề bài, nhóm sử dụng công cụ **k6** (Open source load testing tool) để viết kịch bản và thực hiện kiểm thử hiệu năng dưới dạng code (Performance as Code).

    \subsubsection{a) Viết performance tests cho Login API}
    Dưới đây là đoạn script k6 dùng để test API Đăng nhập:

    \begin{lstlisting}[language=Java, caption={k6 Script cho Login API}]
import http from 'k6/http'
import {sleep, check} from 'k6'
const BASE_URL = 'http://localhost:8080';
export const options = {
    stages: [
        { duration: '20s', target: 100 },   // 100 users
        { duration: '20s', target: 500 },   // 500 users
        { duration: '20s', target: 1000 },  // 1000 users
        { duration: '10s', target: 0 },     // cool down
    ],
}
export default function (){
    const payload = JSON.stringify({
        username: "admin123",
        password: "admin123"
    })
    const params = {
        headers: {
            'Content-Type': 'application/json',
        }
    }
    const res = http.post(`${BASE_URL}/auth/login`, payload, params )
    check(res, {
        'status 200': (r) => r.status === 200,
        'response not empty': (r) => r.body && r.body.length > 0,
    })
    if (res.status !== 200) {
        console.log('Error res:', res.body);
    }
    sleep(1)
}

    \end{lstlisting}
    \subsubsection{b) Viết performance tests cho Product API}
    Dưới đây là đoạn script k6 dùng để test API Product:

    \begin{lstlisting}[language=Java, caption={k6 Script cho Product API}]
import http from 'k6/http';
import { sleep, check } from 'k6';
const BASE_URL = 'http://localhost:8080';

export const options = {
    vus: 100,          // so user dong thoi
    duration: '60s',   // chay 60s
};

export default function () {
    const loginPayloads = JSON.stringify({
        username: "admin123",
        password: "admin123"
    })
    const loginHeaders = {
        headers: {
            'Content-type': 'application/json',
        }
    }
    const loginRes = http.post(`${BASE_URL}/auth/login`, loginPayloads, loginHeaders )
    check(loginRes, {
        'login status is 200': (r) => r.status === 200,
        'receive token': (r) => r.json('accessToken') !== undefined
    })

    if (loginRes.status !== 200) {
        console.log('Login failed:', loginRes.body);
        return;
    }
    const token = loginRes.json('accessToken');
    const productHeaders = {
        headers: {
            Authorization: `Bearer ${token}`,
            'Content-Type': 'application/json'
        }
    }
    const productRes = http.get(`${BASE_URL}/products`, productHeaders);
    check(productRes, {
        'products status is 200': (r) => r.status === 200,
        'response time < 500ms': (r) => r.timings.duration < 500,
        'has products data': (r) => r.json().length > 0,
    });

    sleep(1);
}


    \end{lstlisting}
    \subsubsection{c) Viết Stress tests cho end point get all product}
    Dưới đây là đoạn script k6 dùng để test cho end point get all product

    \begin{lstlisting}[language=Java, caption={k6 Script cho end point get all product}]
import http from 'k6/http';
import { check, sleep } from 'k6';

const BASE_URL = 'http://localhost:8080';

export const options = {
    stages: [
        { duration: '30s', target: 50 },     // Warm-up nhanh
        { duration: '30s', target: 100 },    // Increase load
        { duration: '30s', target: 200 },    // Stress test
        { duration: '30s', target: 300 },    // Peak load
        { duration: '1m', target: 0 },       // Recovery
    ],
    thresholds: {
        http_req_duration: ['p(95)<30000'], //"95% requests phai co response time < 30 giay" // chua sai redis nen kho toi uu hoa db
        http_req_failed: ['rate<0.2'], //"Ty le request failed phai duoi 20%"
    },
};

export default function () {
    const payload = JSON.stringify({
        username: "admin123",
        password: "admin123"
    });

    const login = http.post(`${BASE_URL}/auth/login`, payload, {
        headers: { 'Content-Type': 'application/json' }
    });

    if (login.status !== 200) {
        sleep(0.5);
        return;
    }

    const token = login.json('accessToken');
    const res = http.get(`${BASE_URL}/products`, {
        headers: {
            Authorization: `Bearer ${token}`,
            'Content-Type': 'application/json'
        }
    });

    check(res, {
        'status 200': (r) => r.status === 200,
    });

    sleep(0.5);
}

    \end{lstlisting}

    \subsubsection{d) Kết quả và Phân tích}
    Dựa trên các kịch bản kiểm thử đã thực hiện, nhóm thu được các kết quả như sau:

    \begin{itemize}
        \item \textbf{Kịch bản Login (Load Test - Max 1000 VUs):}
        \begin{itemize}
            \item \textbf{Giai đoạn < 500 VUs:} Hệ thống hoạt động ổn định, thời gian phản hồi trung bình (Avg Response Time) duy trì ở mức thấp (~200ms).
            \item \textbf{Giai đoạn 500 - 1000 VUs:} Thời gian phản hồi bắt đầu tăng tuyến tính theo số lượng user. Tại đỉnh điểm 1000 VUs, độ trễ (p95) đạt khoảng 1.2s nhưng tỉ lệ lỗi (Error Rate) vẫn dưới 1\%, cho thấy server vẫn chịu tải được nhưng bắt đầu có dấu hiệu quá tải nhẹ.
        \end{itemize}

        \item \textbf{Kịch bản Product Flow (Fixed 100 VUs):}
        \begin{itemize}
            \item Với tải cố định 100 người dùng đồng thời liên tục trong 60s, hệ thống xử lý tốt.
            \item \textbf{Kết quả:} 100\% request thành công, thời gian phản hồi p95 đạt chuẩn $< 500ms$. Token được sinh ra và xác thực chính xác trong các request kế tiếp.
        \end{itemize}

        \item \textbf{Kịch bản Stress Test "Get All Products" (Max 300 VUs):}
        \begin{itemize}
            \item \textbf{Vấn đề:} Đây là điểm nghẽn (bottleneck) lớn nhất của hệ thống.
            \item \textbf{Hiện tượng:} Khi VUs vượt quá 200, thời gian phản hồi tăng vọt (có thời điểm chạm ngưỡng 30s như threshold đã thiết lập).
            \item \textbf{Nguyên nhân:} API `GET /products` đang lấy toàn bộ dữ liệu từ Database mà không có phân trang (Pagination) hoặc bộ nhớ đệm (Caching). Việc truy vấn lượng lớn bản ghi đồng thời khiến CPU của Database Server tăng cao và Connection Pool bị cạn kiệt.
        \end{itemize}
    \end{itemize}

    \subsubsection{e) Đề xuất cải thiện (Recommendations)}
    Để khắc phục các vấn đề hiệu năng trên, đặc biệt là endpoint `GET /products`, nhóm đề xuất các giải pháp:

    \begin{enumerate}
        \item \textbf{Triển khai Caching (Redis):}
        \begin{itemize}
            \item Áp dụng Redis để cache lại kết quả của `GET /products`. Khi có request, hệ thống sẽ lấy từ Cache thay vì truy vấn trực tiếp Database, giúp giảm tải cho DB và giảm độ trễ xuống dưới 100ms.
        \end{itemize}

        \item \textbf{Áp dụng Phân trang (Pagination):}
        \begin{itemize}
            \item Thay vì trả về toàn bộ danh sách sản phẩm, API cần hỗ trợ phân trang (ví dụ: `?page=1&size=20`) để giảm dung lượng payload và tốc độ truy vấn.
        \end{itemize}

        \item \textbf{Tối ưu hóa Database Connection:}
        \begin{itemize}
            \item Tăng kích thước Connection Pool (ví dụ: cấu hình HikariCP trong Spring Boot) để đáp ứng lượng request đồng thời cao hơn trong các đợt cao điểm (Peak load).
            \item Đánh Index cho các cột thường xuyên được truy vấn hoặc sắp xếp trong bảng Product.
        \end{itemize}
    \end{enumerate}

    \subsection{7.2. Security Testing}

    \subsubsection{a) Các lỗ hổng phổ biến (Common Vulnerabilities)}
    Nhóm đã thực hiện kiểm thử thủ công và rà soát code để ngăn chặn các lỗ hổng sau:

    \begin{itemize}
        \item \textbf{SQL Injection (SQLi):}
        Sử dụng **Spring Data JPA** và **Hibernate** để tự động parameterized queries, ngăn chặn việc chèn mã SQL độc hại.

        \begin{lstlisting}[language=Java, caption={Ngăn chặn SQL Injection}]
    // An toan: Su dung Parameterized Query cua JPA
    @Query("SELECT u FROM User u WHERE u.username = :username")
    Optional<User> findByUsername(@Param("username") String username);
        \end{lstlisting}

        \item \textbf{Cross-Site Scripting (XSS):}
        Frontend (React) tự động escape các giá trị khi render ra DOM. Backend thực hiện validate input đầu vào, cấm các ký tự đặc biệt không cần thiết trong trường `username` và `product name`.

        \item \textbf{Authentication Bypass:}
        Sử dụng **Spring Security** với JWT (Json Web Token). Mọi API (trừ Login/Register) đều yêu cầu Header `Authorization: Bearer <token>` hợp lệ.
    \end{itemize}

    \subsubsection{b) Các biện pháp bảo mật đã triển khai (Best Practices)}
    \begin{table}[h!]
        \centering
        \begin{tabular}{|l|p{10cm}|}
            \hline
            \textbf{Hạng mục} & \textbf{Giải pháp kỹ thuật} \\
            \hline
            Password Hashing & Sử dụng thuật toán **BCrypt** để mã hóa mật khẩu trước khi lưu vào Database. Không lưu plain-text. \\
            \hline
            CORS Config & Chỉ cho phép các request từ domain của Frontend (ví dụ: localhost:3000) truy cập API. \\
            \hline
            Input Validation & Sử dụng `@Valid`, `@NotNull`, `@Size` trong các DTO (Data Transfer Objects) để đảm bảo dữ liệu sạch ngay từ đầu vào. \\
            \hline
        \end{tabular}
        \caption{Các biện pháp bảo mật hệ thống}
    \end{table}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    \newpage
    \section{KẾT LUẬN}

    Qua bài tập lớn này, nhóm đã hoàn thành việc xây dựng và kiểm thử ứng dụng quản lý sản phẩm theo đúng quy trình:
    \begin{enumerate}
        \item Phân tích yêu cầu kỹ lưỡng trước khi code.
        \item Áp dụng TDD (Test Driven Development) để đảm bảo độ tin cậy của code ngay từ đầu.
        \item Thực hiện Integration Test để đảm bảo các module hoạt động tốt với nhau.
        \item Thiết lập Mock Testing để cô lập lỗi.
        \item Xây dựng pipeline CI/CD để tự động hóa quy trình kiểm thử.
    \end{enumerate}

    Kết quả đạt được là một hệ thống ổn định, độ bao phủ code (Code Coverage) đạt trên 80\%, đáp ứng tốt các yêu cầu đề ra của môn học.

    \newpage

    \begin{thebibliography}{80}

        \bibitem{REACT}
        React Documentation,
        ``\textbf{link: https://react.dev}'',
        \textit{Testing Library Documentation}.

        \bibitem{SPRING}
        Spring Boot Documentation,
        ``\textbf{link: https://spring.io/projects/spring-boot}'',
        \textit{Spring Testing Guide}.

        \bibitem{JEST}
        Jest Documentation,
        ``\textbf{link: https://jestjs.io/}'',
        \textit{JavaScript Testing Framework}.

        \bibitem{JUNIT}
        JUnit 5 User Guide,
        ``\textbf{link: https://junit.org/junit5/}''.

        \bibitem{MOCKITO}
        Mockito Framework,
        ``\textbf{link: https://site.mockito.org/}''.

        \bibitem{CYPRESS}
        Cypress Documentation,
        ``\textbf{link: https://www.cypress.io/}'',
        \textit{End-to-End Testing Framework}.

    \end{thebibliography}
\end{document}